<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KummeraAI Hyper Cinematic Ultimate</title>

<!-- ===================== STYLES ===================== -->
<style>
/* ===================== Body & Themes ===================== */
body.dark {
    background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
    color: white;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    overflow-x: hidden;
}
body.light {
    background: linear-gradient(135deg, #ffffff, #e3e3ff);
    color: black;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    overflow-x: hidden;
}

/* ===================== Animated Title ===================== */
h1.title {
    text-align: center;
    font-size: 48px;
    background: linear-gradient(270deg, #ff00cc, #3333ff, #00ffdd);
    background-size: 600% 600%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    animation: gradientGlow 12s ease infinite;
    margin-top: 10px;
}
@keyframes gradientGlow {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
}

/* ===================== Background Canvas ===================== */
#backgroundCanvas {
    position: fixed;
    top:0; left:0;
    width:100%; height:100%;
    z-index:-1;
}

/* ===================== Chatbox ===================== */
#chatbox {
    width: 90%;
    max-width: 1000px;
    margin: auto;
    height: 550px;
    overflow-y: auto;
    border-radius: 20px;
    padding: 20px;
    display: flex;
    flex-direction: column;
    gap: 12px;
    backdrop-filter: blur(10px);
    background: rgba(0,0,0,0.15);
    box-shadow: 0 0 30px rgba(0,0,0,0.5);
    scroll-behavior: smooth;
}

/* ===================== Chat Bubbles ===================== */
.message {
    margin: 5px;
    padding: 14px 20px;
    border-radius: 20px;
    max-width: 70%;
    word-wrap: break-word;
    font-size: 16px;
    backdrop-filter: blur(12px);
    border: 1px solid rgba(255,255,255,0.2);
    opacity: 0;
    transform: scale(0.7);
    transition: all 0.4s ease;
    position: relative;
}
.message.show { opacity: 1; transform: scale(1); }

.user {
    align-self: flex-end;
    background: rgba(102,255,204,0.25);
    border: 1px solid rgba(102,255,204,0.6);
    color: white;
    animation: popIn 0.3s ease forwards;
}

.ai {
    align-self: flex-start;
    background: rgba(255,153,255,0.25);
    border: 1px solid rgba(255,153,255,0.6);
    color: white;
    animation: popIn 0.3s ease forwards;
}

/* ===================== Pop-in Animation ===================== */
@keyframes popIn {
    0% { transform: scale(0.5); opacity:0; }
    50% { transform: scale(1.05); opacity:1; }
    100% { transform: scale(1); opacity:1; }
}

/* ===================== Typing Animation ===================== */
.ai span {
    opacity: 0;
    display:inline-block;
}

/* ===================== Input Area ===================== */
.inputArea {
    text-align: center;
    margin: 15px;
}
input, select, button {
    padding: 12px;
    margin: 5px;
    font-size: 16px;
    border-radius: 10px;
    border: none;
    outline: none;
}
input { width: 60%; }
select { width: 25%; }
button {
    background: linear-gradient(to right, #ff00cc, #3333ff);
    color: white;
    cursor:pointer;
    transition: all 0.3s ease;
}
button:hover { transform: scale(1.05); }

/* ===================== Settings ===================== */
.settings { text-align: center; margin-bottom: 10px; }

/* ===================== Spinner ===================== */
#spinner {
    display: inline-block;
    width: 22px;
    height: 22px;
    border: 3px solid rgba(255,255,255,0.3);
    border-top: 3px solid white;
    border-radius: 50%;
    animation: spin 1s linear infinite;
    vertical-align: middle;
    margin-left: 10px;
}
@keyframes spin { 0% { transform: rotate(0deg);} 100%{ transform: rotate(360deg);} }

/* ===================== Timestamps ===================== */
.timestamp {
    display: block;
    font-size: 10px;
    text-align: right;
    margin-top: 2px;
    color: rgba(255,255,255,0.7);
}

/* ===================== Markdown + Code Highlight ===================== */
pre {
    background: rgba(0,0,0,0.4);
    padding: 12px;
    border-radius: 10px;
    overflow-x:auto;
    color: #fffa;
}
code { background: rgba(0,0,0,0.2); padding:2px 4px; border-radius:4px; font-family:monospace; color:#ffd700; }

/* ===================== Compact Mode ===================== */
.compact .message { max-width: 60%; font-size: 14px; padding:8px 12px; }

/* ===================== Hover Effects ===================== */
.message:hover { box-shadow: 0 0 15px rgba(255,255,255,0.4); }
</style>
</head>
<body class="dark">

<!-- ===================== Background Canvas ===================== -->
<canvas id="backgroundCanvas"></canvas>

<h1 class="title">KummeraAI Hyper Cinematic Ultimate</h1>

<div class="settings">
<input id="apiKey" type="text" placeholder="Enter OpenAI API Key">
<select id="personality">
<option value="default">Default AI</option>
<option value="friendly">Friendly</option>
<option value="sarcastic">Sarcastic</option>
<option value="professional">Professional</option>
<option value="creative">Creative</option>
</select>
<input id="systemPrompt" placeholder="System prompt (optional)">
<button onclick="toggleTheme()">Switch Theme</button>
<button onclick="clearChat()">Clear Chat</button>
<button onclick="exportChat()">Export Chat</button>
<button onclick="toggleCompact()">Compact Mode</button>
</div>

<div id="chatbox"></div>

<div class="inputArea">
<input id="input" placeholder="Type your message..." autocomplete="off">
<input id="imagePrompt" placeholder="Image prompt (optional)">
<button onclick="send()">Send</button>
<button onclick="generateImage()">Generate Image</button>
<button onclick="startVoice()">ðŸŽ¤ Voice</button>
<button onclick="surpriseMe()">ðŸŽ² Surprise Me</button>
</div>

<!-- ===================== SCRIPT ===================== -->
<script>
// ===================== GLOBALS =====================
let history = [];
let dark = true;
let compact = false;

// ===================== UTILITY =====================
function addMessage(sender,text){
    const chat=document.getElementById("chatbox");
    const ts=new Date().toLocaleTimeString();
    const div=document.createElement("div");
    div.className="message "+sender;
    if(sender==="ai"){
        div.innerHTML="<span></span>";
        chat.appendChild(div);
        typeEffect(div.querySelector("span"),text);
    } else {
        div.innerHTML=text + `<span class="timestamp">${ts}</span>`;
        chat.appendChild(div);
    }
    chat.scrollTop=chat.scrollHeight;
    div.classList.add("show");
}
function typeEffect(element,text){
    let i=0;
    function step(){
        if(i<text.length){
            element.innerHTML+=text[i++];
            element.scrollIntoView({behavior:"smooth"});
            setTimeout(step,15);
        }
    }
    step();
}
function saveSession(){ localStorage.setItem("kummeraHistory",JSON.stringify(history)); }
function loadSession(){
    const data=localStorage.getItem("kummeraHistory");
    if(data){ history=JSON.parse(data); history.forEach(h=>addMessage(h.role,h.content)); }
}

// ===================== THEME & COMPACT =====================
function toggleTheme(){ dark=!dark; document.body.className=dark?"dark":"light"; }
function toggleCompact(){ compact=!compact; document.body.classList.toggle("compact"); }

// ===================== CHAT =====================
async function send(){
    const input=document.getElementById("input");
    const key=document.getElementById("apiKey").value;
    const system=document.getElementById("systemPrompt").value||"";
    const personality=document.getElementById("personality").value;
    if(!key){ alert("Enter API key!"); return; }
    const msg=input.value; if(!msg) return;
    addMessage("user",msg); input.value="";
    const spinner=document.createElement("span"); spinner.id="spinner";
    document.getElementById("chatbox").appendChild(spinner);
    try{
        let messages=[];
        if(system) messages.push({role:"system",content:system});
        if(personality!="default") messages.push({role:"system",content:"You are a "+personality+" AI."});
        messages=messages.concat(history,{role:"user",content:msg});
        const response=await fetch("https://api.openai.com/v1/chat/completions",{
            method:"POST",
            headers:{
                "Content-Type":"application/json",
                "Authorization":"Bearer "+key
            },
            body:JSON.stringify({model:"gpt-4o-mini",messages})
        });
        const data=await response.json();
        spinner.remove();
        const reply=data.choices[0].message.content;
        addMessage("ai",reply);
        const utter=new SpeechSynthesisUtterance(reply); speechSynthesis.speak(utter);
        history.push({role:"user",content:msg});
        history.push({role:"assistant",content:reply});
        saveSession();
    }catch(err){ spinner.remove(); addMessage("ai","Error: "+err.message); }
}

// ===================== SURPRISE ME =====================
function surpriseMe(){
    const prompts=["Tell me a joke","Generate a poem","Describe a futuristic city","Give me a riddle","Write a short story","Explain a scientific fact","Make a funny meme description"];
    const prompt=prompts[Math.floor(Math.random()*prompts.length)];
    document.getElementById("input").value=prompt;
    send();
}

// ===================== IMAGE GENERATION =====================
async function generateImage(){
    const key=document.getElementById("apiKey").value;
    const prompt=document.getElementById("imagePrompt").value;
    if(!key||!prompt){ alert("Enter API key and prompt!"); return; }
    addMessage("user","Image prompt: "+prompt);
    const spinner=document.createElement("span"); spinner.id="spinner";
    document.getElementById("chatbox").appendChild(spinner);
    try{
        const response=await fetch("https://api.openai.com/v1/images/generations",{
            method:"POST",
            headers:{"Content-Type":"application/json","Authorization":"Bearer "+key},
            body:JSON.stringify({prompt,n:1,size:"512x512"})
        });
        const data=await response.json(); spinner.remove();
        const imgUrl=data.data[0].url;
        const img=document.createElement("img"); img.src=imgUrl;
        img.style.maxWidth="80%"; img.style.borderRadius="12px"; img.style.margin="5px";
        document.getElementById("chatbox").appendChild(img);
        document.getElementById("chatbox").scrollTop=document.getElementById("chatbox").scrollHeight;
        history.push({role:"user",content:"Image prompt: "+prompt});
        history.push({role:"assistant",content:"[Generated Image]"});
        saveSession();
    }catch(err){ spinner.remove(); addMessage("ai","Error generating image: "+err.message); }
}

// ===================== VOICE =====================
function startVoice(){
    const rec=new (window.SpeechRecognition||window.webkitSpeechRecognition)();
    rec.onresult=e=>{ document.getElementById("input").value=e.results[0][0].transcript; };
    rec.start();
}

// ===================== EXPORT / CLEAR =====================
function exportChat(){
    const text=history.map(h=>`${h.role}: ${h.content}`).join("\n");
    const blob=new Blob([text],{type:"text/plain"});
    const a=document.createElement("a"); a.href=URL.createObjectURL(blob); a.download="kummera_chat.txt"; a.click();
}
function clearChat(){ document.getElementById("chatbox").innerHTML=""; history=[]; localStorage.removeItem("kummeraHistory"); }

// ===================== KEYBOARD SHORTCUTS =====================
document.getElementById("input").addEventListener("keydown",e=>{
    if(e.key==="Enter"&&!e.shiftKey){ e.preventDefault(); send(); }
});

// ===================== LOAD SESSION =====================
loadSession();

// ===================== BACKGROUND PARTICLES =====================
const canvas=document.getElementById("backgroundCanvas"); const ctx=canvas.getContext("2d"); canvas.width=window.innerWidth; canvas.height=window.innerHeight;
let particles=[]; for(let i=0;i<150;i++){ particles.push({x:Math.random()*canvas.width,y:Math.random()*canvas.height,vx:(Math.random()-0.5)/2,vy:(Math.random()-0.5)/2,size:Math.random()*2+1}); }
function animateParticles(){ ctx.clearRect(0,0,canvas.width,canvas.height); particles.forEach(p=>{ p.x+=p.vx; p.y+=p.vy; if(p.x<0||p.x>canvas.width)p.vx*=-1; if(p.y<0||p.y>canvas.height)p.vy*=-1; ctx.fillStyle="rgba(255,255,255,0.3)"; ctx.beginPath(); ctx.arc(p.x,p.y,p.size,0,2*Math.PI); ctx.fill(); }); requestAnimationFrame(animateParticles); }
animateParticles(); window.addEventListener("resize",()=>{canvas.width=window.innerWidth; canvas.height=window.innerHeight;});
</script>

</body>
</html>
